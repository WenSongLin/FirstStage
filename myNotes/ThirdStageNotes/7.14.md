Nginx:负载均衡的服务器,对访问的请求分发到不同的tomcat中，减轻单台tomcat的压力，不至于崩溃

sentinel集群：tomcat直接连接sentinel，sentinel全天不间断的监控着redis，如果有一台redis服务器崩溃了，就会从其他redis服务器中选择一台，代替“主-写”服务器，而崩溃的服务器重新上线后，则会代替前一台服务器做“从-读”；

redis集群：部署多台redis服务器，分配其中一台为“主-写”，其他服务器为“从-读”，避免其中一个挂了，整个系统的redis都失效。由sentinel对redis集群进行监控，避免整体崩溃

mycat：tomcat写入数据库时，直接连接mycat，由mycat进行对myBatis的分发



- 微服务：不同于传统的tomcat部署，微服务将不同的模块拆分，部署在不同的服务器中，即，每台服务器都是一个项目。哪台服务器压力大，就可以单独部署多台，以减轻压力。
  - 但由于使用了不同的服务器，所以每个模块的ip地址都不相同，此时还需要一台注册中心的服务器，不同的的请求先去注册中心去查找对应的ip地址，

# 微服务注册中心

> CAP理论

```:bullettrain_front:
CAP理论是分布式系统中一个很重要的理论，它描述的是一个分布式系统最多只能满足CAP中的两个条件，不可能同时满足三个条件

	C（Consistency）：这里指的是强一致性。保证在一定时间内，集群中的各个节点会达到较强的一致性，同时，为了达到这一点，一般会牺牲一点响应时间。而放弃C也不意味着放弃一致性，而是放弃强一致性。允许系统内有一定的数据不一致情况的存在

	A (Avalibility)：可用性。意味着系统一直处于可用状态。个别节点的故障不会影响整个服务的运作

	P（Partition Tolerance)：分区容忍性。当系统出现网络分区等情况时，依然能对外提供服务。想到达到这一点，一般来说会把数据复制到多个分区里，来提高分区容忍性。这个一般是不会被抛弃的

```

# 创建高可用的Eureka服务端

## 原理

> 强一致性

```markdown
用户所有的请求由中心服务器进行接收，并转发给下属服务器组，中心服务器作为首领会可能会导致单点雪崩，业内的解决方案是中心服务器雪崩之后，选举一个下属服务器作为新的首领，但由于网络延时等因素可能会产生多个首领，产生”脑裂”效益。
```

> 高可用性

```markdown
服务器集群采取两两互相注册的方式形成一个环形集群。当客户端访问时，当前节点无法访问则自动轮转至下一个节点。相比于CP模型，由于节点互相集群，客户端请求的一致性得不到保障。
```

## 配置方式

> 原理：假设有两台Eureka服务器，那么我们只需要将这两台服务器的注册中心地址填对方即可完成两两注册。





